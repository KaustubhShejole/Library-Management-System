<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Departmental Library Management System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="css/styles.css">

    <script type = "text/javascript" >
    function preventBack() { window.history.forward(); }
    setTimeout("preventBack()", 0);
    window.onunload = function () { null };
    </script>
</head>

<body>

  <div class="businessup-nav-widget-area">
    <div class="container">
        <div class="row">
            <div class="col-md-3 col-sm-4 text-center-xs">
                <div class="navbar-header">
                    <!-- Logo -->
                    <a href="https://vnit.ac.in/cse/" class="navbar-brand" rel="home" aria-current="page">
                        <img width="600" height="105" src="https://vnit.ac.in/cse/wp-content/uploads/2018/10/vnitnew-logo-sample-img.jpg" class="custom-logo" alt="Department of Computer Science &amp; Engineering" decoding="async" srcset="https://vnit.ac.in/cse/wp-content/uploads/2018/10/vnitnew-logo-sample-img.jpg 600w, https://vnit.ac.in/cse/wp-content/uploads/2018/10/vnitnew-logo-sample-img-300x53.jpg 300w" sizes="(max-width: 600px) 100vw, 600px">
                    </a>
                    <!-- Logo -->
                </div>
            </div>
            <div class="col-md-9 col-sm-8">
                <div class="header-widget" style="padding-left: 50px;padding-top:10px;">
                  <form action="/" method="post" class="action-form">
                      <button style="float:right;" type="submit" class="btn btn-primary">DLMS</button>
                  </form>
                </div>
            </div>
        </div>
    </div>
</div>
<style media="screen">
  .menu-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 10px;
    margin-top: 10px;
    margin-right: 20px;
    margin-left: 20px;
  }

  .option {
    padding: 10px;
    border: 1px solid #ccc;
    cursor: pointer;
    border-radius: 5px;
  }

  .option.selected {
    background-color: lightblue;
  }

  .option::after {
    content: 'âœ“';
    float: right;
    visibility: hidden;
  }

  .option.selected::after {
    visibility: visible;
  }
  .option:hover {
  background-color: #facaee;
  cursor: pointer;
  }
</style>
<center>
  Insert a new Category
</center>
<div class="category-form" style="text-align: center;">
  <form class="categoryInsert" action="/update_category" method="post">
    <div class="div_for_id" style="display:none;">
      <input type="text" name="categoryId" value="<%= category._id %>" class="form-control">
    </div>
    <div class="category_name">
        <label for="category_name">Category Name:</label>
        <input type="text" name="name" value="<%= category.name %>" class="form-control">
    </div>
    <div class="select_subjects">
        <label for="select_subjects">Please Select appropriate subjects:</label>
        <div class="menu-grid" >
            <% category.subjects.forEach(subject => { %>
                <div class="option selected" data-value="<%= subject %>">
                    <%= subject %>
                    <input type="hidden" name="selectedSubjects" value="<%= subject %>" class="hidden-input">
                </div>
            <% }); %>
            <% subjects.forEach(subject => { %>
              <% if (!category.subjects.includes(subject)) { %>
                <div class="option" data-value="<%= subject %>">
                  <%= subject %>
                  <input type="hidden" name="selectedSubjects" value="" class="hidden-input">
                </div>
              <% } %>
            <% }); %>
        </div>
    </div>
    <div class="div_for_parentHref" style="display:none;">
      <input type="text" name="parentHref" value="update_category" class="form-control">
    </div>
    <button type="submit" class="btn btn-primary" style="width: 80%; margin-left: 10%; margin-right: 10%; margin-top: 2%;margin-bottom: 2%;">Update the Category</button>
    </form>

    <button id = "clear_all" class="btn btn-primary" style="width: 80%; margin-left: 10%; margin-right: 10%; margin-top: 2%;margin-bottom: 2%;">Clear all</button>
    <button id = "select_all" class="btn btn-primary" style="width: 80%; margin-left: 10%; margin-right: 10%; margin-top: 2%;margin-bottom: 2%;">Select all</button>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        const options = document.querySelectorAll('.option');

        options.forEach(option => {
            option.addEventListener('click', function () {
                const hiddenInput = option.querySelector('.hidden-input');
                if (hiddenInput.value === '') {
                    hiddenInput.value = option.dataset.value;
                    option.classList.add('selected');
                } else {
                    hiddenInput.value = '';
                    option.classList.remove('selected');
                }
            });
        });

        const clearButton = document.getElementById('clear_all');

        clearButton.addEventListener('click', function(){
            const options = document.querySelectorAll('.option');
            options.forEach(option => {
                option.classList.remove('selected');
                const hiddenInput = option.querySelector('.hidden-input');
                hiddenInput.value = '';
            });
        });

        const selectButton = document.getElementById('select_all');

        selectButton.addEventListener('click', function(){
          options.forEach(option => {
              option.classList.add('selected');
              const hiddenInput = option.querySelector('.hidden-input');
              hiddenInput.value = option.dataset.value;
          });
        });
    });
</script>

</div>

<script type="text/javascript">
  function toggleOption(event) {
  const target = event.target;
  if (target.classList.contains('option')) {
    target.classList.toggle('selected');
  }
}

</script>
</body>
</html>
